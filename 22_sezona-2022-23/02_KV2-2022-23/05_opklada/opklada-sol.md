---
title: Опклада - опис решења
---

## Опклада

Аутор: Павле Мартиновић 
Текст: и тест примери: Павле Мартиновић
Анализа решења: Павле Мартиновић
Тестирање: Алекса Милисављевић

###  Решење када је $l_{i,j}=u_{i,j}$
Нека је $c_i$ број операција које смо применили на $i$-ту колону, а $r_i$ број операција које смо применили на $i$-ти ред. Преимтимо да је онда $m_{i,j}=r_{i}-c_{j}$. Из овога можемо да закључимо да је $m_{i,j}=r_{i}-c_{j}=r_{i}+r_{1}-c_{j}-c_{1}-m_{1,1}=(r_i-c_1)+(r_1-c_j)+m_{1,1}=m_{i,1}+m_{1,j}-m_{1,1}$. Може се без већих потешкоћа доказати да је овај услов потребан и довољан услов за Момирову крајњу табелу (суштински решавањем система једначина за $r_i$ и $c_i$). Тако да је потребно само проверити услов и налазимо решење у $O(TNM)$.
###  Решење када је $l_{i,j}=u_{i,j}$ у првом реду и колони
Из претходног подзадатка можемо да видимо заправо да пошто су нам фиксирани први ред и колона да нам је остатак табеле фиксриан. Онда само израчунамо које вредности морају да се налазе на крају у сваком пољу и проверимо да ли је у траженом интервалу. Сложеност:  $O(TNM)$.
### Решење када je $u_{i,j}-l_{i,j}\leq1$ и $N,M<=10$
У овом подзадатку користимо решење претходног. Наиме приметимо да за вредности у првом реду и колони имамо највише $2^{M+N-1}$ опција. Фиксирамо сваку од тих опција и пробамо алгоритмом сличан ономе у претходном подзадатку (са потенцијално неким одсецањем због убрзања). Сложеност:  $O(T2^{M+N}NM)$
### Решење када је $l_{i,j}=u_{i,j}$ у свим белим пољима
Вратимо се на интерпретацију $m_{i,j}=r_{i}-c_{j}$. Видимо да нам поље где је $l_{i,j}=u_{i,j}$ даје јединствену везу између $r_{i}$ и $c_{j}$. Због услова овог задатка, све вредности $r_i$ и $c_i$ ћемо моћи да изразимо само преко $r_1$ или само преко $r_2$. Када се те везе испуне и убаце у неједначине осталих поља, онда ће сва преостала поља да нам дају неке неједначине облика $a\le r_1-r_2\le b$. Комбинујући ове неједнакости по свим пољима, налазимо у ком интервалу $r_1-r_2$ заиста треба да буде (као пресек свих горенаведених интервала), и одатле можемо да узмемо произвољну вредности. На крају пустимо алгоритам из трећег подзадатка (другом у овом текстуалном решењу), да бисмо видели да ли је валидно решење то које смо нашли.
### Решење без додатних ограничења
Приметимо да нам се услови у суштини своде на $l_{i,j}\leq r_i-c_j\leq u_{i,j}$. Презапишимо ово као $r_i-c_j\leq u_{i,j}$ и $c_j-r_i\leq-l_{i,j}$. Сада смо свели задатак: на решавање система неједначина по променљивима $x_1,x_2\cdots,x_{M+N}$ где је свака неједначина облика $x_i-x_j\leq c$. Постоји генерални начин на који се ово решава који ћемо презентовати овде.

Направимо граф чији чворови одговарају променљивима нашег система неједначина. Направимо за сваку неједначину облика $x_i-x_j\leq c$ грану од чвора $j$ до чвора $i$ са тежином $c$. Пустићемо алгоритам Белман-Форд да бисмо нашли дистанцу од $1$ до сваког другог чвора у овом графу. Тврдимо да уколико у нашем графу постоји негативан циклус, одговор је да решење не постоји, док ако не постоји негативан циклус, решење увек постоји и налазимо га као $x_i=dist(1,i)$. Уколико постоји негативан циклус, онда нека је то циклус $a_1,a_2,\cdots,a_k$. Тада за њих имамо неке неједнакости облика $x_{a_i}-x_{a_{i+1}}\leq c_{i}$ (индекси узети по модулу $k$). Сада кад саберемо ове једначине, сваки од променљивих нам се скрати и добијамо $0\leq c_1+c_2+\cdots+c_k<0$ (јер је у питању негативан циклус). Из овога закључујемо да кад има негативан циклус, решење заиста не постоји. Сада претпоставимо да негативан циклус не постоји. Докажимо да је $x_i=dist(1,i)$ заиста решење. Треба да се уверимо да је $dist(1,i)-dist(1,j)\leq c$, односно $dist(1,j)+c\geq dist(1,i)$, што је свакако тачно јер је десна страна најкраћи пут од $1$ до $i$, док лева страна представља неки пут од $1$ до $i$, где прво идемо до $j$ а онда од $j$ до $i$ директном граном тежине $c$. Овиме смо се уверили да је ово заиста решење.

Најзад да бисмо финиширали задатак, потребно је дати две фусноте на претходни алгоритам. Прва је да су неке вредности променљивих можда негативне, а нама требају само позитивне вредности. Ово, међутим, није проблем јер можемо свим променљивама да додамо неко $k$ да би смо добили опет валидно решење система, где су све промељиве веће за $k$, па за довољно велико $k$ и позитивне. Друга битна ствар је да решење оваквог система једначина, у генералном случају, не мора бити само од целих бројева. Међутим, због начина који смо нашли решења, то јест као најкраћи пут у неком графу где су тежине свих грана целе, онда ће ово решење које смо детектовали у горњем алгоритму ипак бити валидно.

Овиме смо решили задатак у $O(TNM(N+M))$.
