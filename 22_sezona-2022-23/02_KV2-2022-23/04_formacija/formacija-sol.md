---
title: Формација - опис решења
---

# Формација

Аутор: Младен Пузић
Текст и тест примери: Младен Пузић
Тестирање: Павле Мартиновић
Анализа решења: Младен Пузић

За три тачке $A, B$ и $C$ кажемо да тројка $(A, B, C)$ има леви заокрет уколико ако се крећемо од $A$ до $C$ преко тачке $B$ морамо скренути у лево. Слично дефинишемо десни заокрет. Тачке $A, B$ и $C$ су колинеарне уколико постоји права која садржи све три. Све ово можемо проверити користећи векторски производ вектора $\overrightarrow{AB}$ и $\overrightarrow{BC}$.

### Решење када $N = 3$
За сваки подскуп потребно је проверити посебно. Имамо три подскупа са два играча, где је потребно проверити да ли се Меси налази на дужи између та два играча. То можемо тако што проверимо да ли је колинеаран са та два играча, као и да су му $x$ и $y$ координатe између њихових.

Такође је потребно проверити за подскуп од сва три фудбалера. Ако је Меси у тачки $M$, а три дате тачке $A, B$ и $C$, онда је потребно да тројке $(A, B, M)$, $(B, C, M)$ и $(C, A, M)$ имају исти заокрет, како би се $M$ налазио у конвексном омотачу тачака $A, B$ и $C$.

Временска и меморијска сложеност је $O(1)$.

### Решење када $y_1 = 1$ и $y_k = -1$, за $1 < k \leq N$

Јасно је да ћемо играча са дресом број $1$ морати да укључимо у подскуп како би конвексни омотач садржао тачку $(0, 0)$. 

Посматрајмо тачку $(-x_1, -1)$. Постоји два случаја:

- Уколико постоји играч који се налази у тој тачки, тада, ако га укључимо у подскуп, можемо узети било који подскуп осталих играча, којих има $2^{N-2}$. Сем тога, морамо додати број подскупова у којима се не налази тај играч;
- Уколико не постоји играч у тој тачки, нећемо додати $2^{N-2}$ на решење.

Рецимо да посматрамо број подскупова који не садрже играча у тачки $(-x_1, -1)$ (ако такав уопште постоји). Јасно је да онда морамо узети макар једног играча лево (односно са мањом $x$ координатом) од те тачке и макар једног играча десно (односно са већом $x$ координатом). Ако са $L$ означимо број играча лево, а са $R$ број играча десно, онда је решење $(2^L-1)\cdot (2^R - 1)$ (на шта додајемо $2^{N-2}$ уколико постоји играч у тачки $(-x_1, -1)$).

Временска сложеност је $O(NlogN)$, а меморијска $O(N)$.

### Решење када $y_k \in \{-1, 1\}$, за $1 \leq k \leq N$

Слично претходном решењу, морамо да имамо макар по једног играча са обе $y$ координате. Ако фиксирамо најлевљу и најдешњу тачку са праве $y = 1$ из подскупа који бирамо, онда поново налазимо $L$ и $R$ и примењујемо сличну формулу као у претходном решењу. 

Ово је преспоро па је потребно да приметимо да $L$ зависи само од најлевље одабране тачке, а $R$ само од најдешње одабране тачке. Ово користимо уз технику префиксних сума, да нађемо збир свих подскупова за фиксирану најлевљу тачку (а кроз све могуће најдешње). 

Временска сложеност је $O(NlogN)$, а меморијска $O(N)$.


### Решење када $N \leq 18$
За сваки подскуп тачака, нађимо конвексни омотач неким познатим алгоритмом (нпр. монотони ланац) и онда проверимо да ли се тачка $(0, 0)$ налази у њему. То можемо урадити тако што идемо у круг кроз ивице омотача и проверавамо да ли све ивице имају исти заокрет са тачком $(0, 0)$.

Временска сложеност је $O(2^N \cdot N)$, а меморијска $О(N)$.

### Главно решење
Уместо да рачунамо број подскупова у чијем конвексном омотачу се Меси налази, од $2^N - 1$ одузмимо број подскупова у чијем конвексном омотаче се **не налази** Меси. То радимо зато што је лакше проверити овај услов - довољно је да постоји права кроз $(0, 0)$, тако да су све тачке подскупа са исте стране ове праве.

Претпоставићемо да нема колинеарних тачака (чак ни кад рачунамо Месијеву позицију). Решање колинеарних тачака сведе се детаље имплементације. Кренувши од позитивне $x$ осе, сортирајмо тачке по поларном углу око тачке $(0, 0)$, растуће. Означимо са $M$ тачку $(0, 0)$. 

Фиксирајмо сваку тачку $p_i$ и са $cnt$ означимо број других тачака које имају леви заокрет са вектором од $p_i$ до $M$. Онда је број подскупова у којима је $p_i$ *најлевља* тачка (тачка таква да није заокрет $(M, x, p_i)$ није надесно, за свако $x$ у подскупу),  а да конвексни омотач не садржи тачку $M$ - $2^{cnt}$. Када од $2^N - 1$ одузмемо овај резултат за сваку тачку $p_i$, добијемо коначно решење. Број $cnt$ можемо одржавати техником два показивача.

Временска сложеност је $O(NlogN)$, а меморијска $O(N)$.





