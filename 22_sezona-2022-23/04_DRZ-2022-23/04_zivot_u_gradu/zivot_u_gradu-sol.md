---
title: Живот у граду - опис решења
---

# Живот у граду

Аутор: Павле Мартиновић
Текст и тест примери: Павле Мартиновић
Анализа решења: Драган Урошевић
Тестирање: Алекса Милисављевић


### Решење првог подзадатка
У овом случају, због ограничења на дужину величину табле могуће је у датом временском ограничењу проверити све путеве и одредити за сваки од њих колико се концерата одржава на том путу. Наиме, број разних путвеа је $2^{N+M-2}\leq 2^{18}$. Наравно, ако је на неком путу број концерата баш $K$, прекида се проверавање путева, исписује одговор  "DA" и ако је потребно исписује одговарајући пут. Ако ни на једном путу није било $K$ концерта, исписује се одговор "NE". Сложеност описаног решења је ${\mathcal O}(2^{N+M})$.

### Решење другог и трећег подзадатка
За почетак је потребно одредити подматрицу коју чине поља на којима се одржавају концерти. Након тога треба дискутовати (разликовати) неколико случајева, у зависности од димензија и позиције подматрице и броја $K$. Мислимо да нема потребе да изводимо комплетну дискусију. Сложеност описаног решења је ${\mathcal O}(NM)$.
 

### Решење четвртог и петог подзадатка
Ови подзадаци се могу решити применом динамичког програмирања. Нека је $dp[i][j][l]=true$, ако постоји пут од поља $(1,1)$ до поља $(i,j)$ на коме постоји $l$ поља на којима се одржава концерт и $dp[i][j][l]=false$ у супротном. Тада је $dp[N][M][K]$ одговор на питање да ли постоји тражени пут или не. Низ $dp$ попуњавама (рачунамо) врста по врста:

- $dp[1][1][1]=true$, ако се на пољу $(1,1)$ одржава концерт и $dp[1][1][1]=false$, ако се на пољу $(1,1)$ не одржава концерт.
- $dp[1][1][0]=true$, ако се на пољу $(1,1)$ не одржава концерт и $dp[1][1][0]=false$, ако се на пољу $(1,1)$ одржава концерт.
- $dp[1][1][l]=false$, за $2\leq l \leq K$.
- Ако се на пољу $(i,j)$  одржава концерт, онда је $dp[i][j][l]=true$, ако и само ако је $dp[i-1][j][l-1]=true$ или $dp[i][j-1][l-1]=true$ (наравно, ако је $i \geq 2$ и $j \geq 2$, у супротном, одговарајући елемент не постоји). Приметимо такође да је у овом случају $dp[i][j][0]=false$.
- Ако се на пољу $(i,j)$  не одржава концерт, онда је $dp[i][j][l]=true$, ако и само ако је $dp[i-1][j][l]=true$ или $dp[i][j-1][l]=true$ (наравно, ако је $i \geq 2$ и $j \geq 2$, у супротном, одговарајући елемент не постоји).

Ако тражени пут постоји, он се може реконстрисати коришћењем низа $dp$. Наиме, крећемо од поља $(N,M)$ и тражимо пут на коме се одржава $K$ концерта. Ако се налазимо на пољу $(i,j)$ и тражимо пут на коме се одржава $l$ концерта, онда мора бити $dp[i][j][l]=true$ и могу наступити следећа два случаја:

- На пољу $(i,j)$ се оджава концерт. Тада број концерата смањујемо за један, тј. $l$ се смањује за један ($l \leftarrow l-1$) и померамо се на поље лево или горе (ако постоји) за које одговарајући елемент низа $dp$ ($dp[i-1][j][l-1]$ или $dp[i][j-1][l-1]$) има вредност $true$.
- На пољу $(i,j)$ се не оджава концерта. Тада број коцерта остаје непромењен, а померамо се на поље лево или горе (ако постоји) за које одговарајући елемент низа $dp$ ($dp[i-1][j][l]$ или $dp[i][j-1][l]$) има вредност $true$.
- Поступак прекидамо када стигнемо до поља $(1,1)$.

Сложеност описаног решења је одређена сложеношћу попуњавања низа $dp$ и износи ${\mathcal O}(NMK)$.


### Решење шестог подзадатка

У овом случају можемо формирати граф у коме су чворови поља на која је подељен град, а ивице постоје од поља до његових суседа лево и доле. Поља на којима се одржавају концерти су забрањена и на њих се не може стати. Тражени пут постоји, ако постоји пут у графу (пут заобилази забрањена поља). Тај пут можео пронаћи, на пример, применом обиласка у ширину. За свако поље можемо памтити одакле смо стигли и на тај начин реконструисати решење. Сложеност описаног решења је ${\mathcal O}(NM)$.


### Главно решење

Нека је $dp_1[i][j]$ минимални број $l$ такав да постоји пут од поља $(1,1)$ до поља $(i,j)$, на коме се одржава $l$ концерата. Нека је $dp_2[i][j]$ максимални број $l$ такав да постоји пут од поља $(1,1)$ до поља $(i,j)$, на коме се одржава $l$ концерата. Тада за свако поље $(i,j)$ важи да постоји пут од поља $(1,1)$ до поља $(i,j)$ на коме се одржава $l$ концерта, где је $l$ било који број између $dp_1[i][j]$ и $dp_2[i][j]$  ($dp_1[i][j]\leq l  \leq dp_2[i][j]$). Наиме од било ког почетног пута између два поља се може стићи до било ког завршног, тако што се прелази преко низа путева од којих се свака два узастопна разликују у само једном пољу. Када се на путу промени само једно поље и број поља на којима се одржава концерт се може променити (смањити или повећати) за највише један (1). Ако кренемо од пута са минималним бројем концерта према путу са максималним бројем концерта, проћи ћемо преко путева на којима је број концерта било који број између та два броја. 
Због тога, постоји пут са тачно $K$ концерата, ако и само ако је $dp_1[N][M]\leq K  \leq dp_2[N][M]$.
Низове $dp_1$ и $dp_2$ рачунамо на сличан начин као низ $dp$ у четвртом и петом подзадатку:

- Ако се на пољу $(1,1)$ одржава концерт, онда је $dp_1[1][1]=dp_2[1][1]=1$.
- Ако се на пољу $(1,1)$ не одржава концерт, онда је $dp_1[1][1]=dp_2[1][1]=0$.
- Ако се на пољу $(i,j)$ одржава концерт, онда је $dp_1[i][j]=\min(dp_1[i-1][j],dp_1[i][j-1])+1$ и $dp_2[i][j]=\max(dp_2[i-1][j],dp_2[i][j-1])+1$.
- Ако се на пољу $(i,j)$ не одржава концерт, онда је $dp_1[i][j]=\min(dp_1[i-1][j],dp_1[i][j-1])$ и $dp_2[i][j]=\max(dp_2[i-1][j],dp_2[i][j-1])$.

Ако постоји пут са тачно $K$ концерата, онда се он реконструише тако што се крене од поља $(N,M)$ и тражи пут који има $l=K$ концерата. Ако се налазимо на пољу $(i,j)$ и тражимо пут који има $l$ концерата ($dp_1[i][j]\leq l \leq dp_2[i][j]$), онда могу наступити два случаја:

- Ако се на пољу $(i,j)$ одржава концерт, онда треба смањити број концерата $l$ за један и прећи на поље изнад или поље лево, тако да број концерата буде између $dp_1$ и $dp_2$ за то ново поље.
- Ако се на пољу $(i,j)$ не одржава концерт, онда се број концерата $l$ не мења, а треба прећи на поље изнад или поље лево, тако да број концерата буде између $dp_1$ и $dp_2$ за то ново поље.
- Поступак прекидамо када стигнемо до поља $(1,1)$.

Сложеност описаног решења је одређена сложеношћу попуњавања низова $dp_1$ и $dp_2$ и износи ${\mathcal O}(NM)$.
