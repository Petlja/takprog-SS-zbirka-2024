# Парови

Аутор: Јован Бенгин
Текст и тест примери: Јован Бенгин
Тестирање: Јован Бенгин
Анализа решења: Момчило Тошић

### Решење кад $M \leq 18$

У овом случају можемо испробати свако разапињујуће стабло (бирањем сваког подскупа грана), наћи сва минимална и за сваки пар чворова (којих исто има мало јер је граф повезан) наћи и додати решење. 
Тада је сложеност $O(N^2 2^M)$

### Решење кад $M = K, N \leq 50$

Уочимо да ће тежина сваке гране бити 1. Дакле, МСТ је свако разапињујуће стабло, а како је и број чворова мањи, можемо да израчунамо решење за сваки пар на тзв. похлепан начин.
Овде је потребно урадити анализу случајева, пребројимо све чворове са директним везама до она два које посматрамо, одузимајући оне који су заједнички (с тим да се с једним
могу оба повезати уколико не постоји грана између њих).
Сложеност ће бити $O(N^2(N+M))$.

### Решење кад је $N \leq 100, M \leq 200$

Можемо поново решавати за свака два чвора, с тим што пуштамо симулацију налажења МСТ са оптималним бирањем грана тако да се максимизују оне које укључују неки од два одабрана чвора.
Сложеност је у овом случају $O(N^2 М\log{M})$.

### Решење кад $K \leq 6$

За ово решење потребно је прећи на другачији начин пребројавања (који се користи и у целон решењу) - групишемо гране са једнаким тежинама (кажемо да је чвор у групи ако
постоји грана у групи која га садржи) и бројимо колико пута гране
из дате групе „фигуришу“ у коначном збиру (дакле, бар један од селектованих чворова је неки из групе).
Пошто Крускалов алгоритам додаје гране у сортираном редоследу, можемо рачунати да када посматрамо групу тежине $W$, чворови су већ повезани
у компоненте које формирају гране тежина испод $W$. Да би се формирао МСТ, свакако се у њега додаје неки подскуп нових грана, а како је број $K$ мали,
можемо ручно пробати сваки подскуп и видети колико гране доприносе збиру (за свака два чвора која се појављују у групи као крајеви веза). Како има $\frac{M}{K}$ група,
а $O(K)$ и чворова и грана у групи, сложеност је $O(2^K MK)$.

### Решење за пун број поена

Могуће је извршити пребројавање појављивања грана у макс степенинма чворова из групе и брже, тако да не постоји додатни фактор осим квадратног по $K$. Посматрајмо
везе чворова из групе са већ формираним компонентама.
Фиксирамо 2 чвора у групи и за њих додајемо број компоненти с којима су повезани, одузимајући број с којим су оба повезана, са обраћањем пажње на специјалне
случајеве (неки од два чвора повезан је са компонентом од овог другог, у истој су компоненти, или постоји директна веза између два селектована чвора).
Овде се ради нешто донекле слично као у другом подзадатку, с тим што је (условно речено) тада једина група био скуп свих чворова, сада треба додати и допринос грана у 
тренутној групи на збир степена кад селектован пар укључује један чвор који се не појављује у групи, мада ово се рачуна само као број компоненти с којим је повезан
онај чвор који јесте у групи (наравно онолико пута колико има чворова ван групе). Након овог процеса, ажурирамо компоненте и прелазимо на наредну групу.
Укупна сложеност је (истим резоном као и пре) $O(MK)$.
