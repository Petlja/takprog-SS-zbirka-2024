---
title: Битвајз орање - опис решења
---

# Битвајз орање
Аутор: Павле Мартиновић
Текст и тест примери: Александар Вишњић
Анализа решења: Павле Мартиновић
Тестирање: Павле Мартиновић

## Решење када $N=2$

Видимо да уколико је у питању интервал дужине $1$, Ања има победничку стратегију само са један број (управо ту вредност). Уколико је интервал дужине $2$, онда Богдан бира да ли ће на та два применити `or` или `xor`, тако да Ања може победити само за једну вредност и то само уколико су $a\bigoplus b$ и $a|b$ једнаки. 
## Када Ања има победничку стратеију?

Докажимо следеће тврђење: За сваки позицију бита $i$ погледајмо у колико елемената је иницијално постављен на $1$. Уколико је сваки бит највише једном постављен на $1$, онда Ања побеђује за тачно једну вредност, а уколико није тако, онда Ања никад не побеђује.

Заиста, ако се сваки бит јавља највише једном, онда ма шта радили Ања и Богдан, на крају ће се добити број који има јединице управо на позицијама на којима постоји јединица на неком иницијалних бројева. (ово се може нпр формално видети индукцијом). Уколико постоји неки бит на ком бар два иницијална броја имају јединице, онда Богдан може да намести да је вредност на тој позицији или $0$ или $1$ на крају како жели, и самим тим избегне било који Ањин циљни број. Наиме, он може да увек бира да ради $a|b$, док не остану тачно два броја са тим битом. Надаље ради произвољно док га не пита управо за та два броја што имају јединицу на биту који посматрамо (ако учествује само један такав број у операцији, не смета Богдану ништа јер шта год радио, нови број ће опет имати јединицу на тој позицији, па ће још увек остати тачно два броја са јединицом на тој позицији). Уколико жели да добије на крају $0$ на тој позицији, урадиће $a\bigoplus b$ и неће остати ниједна јединица на тој позицији, па ће и на крају ту бити $0$. Са друге стране ако жели на крају да добије $1$ на тој позицији, урадиће $a|b$, па ће остати једна јединица на тој позицији, а надаље шта год Ања и Богдан радили ће остати тачно једна јединица на тој позицији, слично првом решењу. Овиме је тврђење доказано.

## Решење када су све вредности $1$, $2$ или $3$

Може се  лако доказати из претходног да овде Ања има победничку стратегију за једну вредност ако је низ дужине $1$ или је скуп карата управо $\{1,2\}$, у супротном је одговор $0$. 
## Решење када су све вредности степени двојке

Може се доказати из претходног да овде Ања има победничку стратегију за једну вредност ако  и само ако су све вредности низа различите, а у супротном је одговор $0$. Имплементацију овог можемо урадити тако што ако је интервал дужине преко $60$ само кажемо да је одговор $0$ (јер постоји само $60$ различитих вредности), а у супротном можемо да га сортирамо и видимо да ли су суседне вредности различите, што нам даје да на сваки упит можемо одговорити у сложености $O(\log\max A_i\log\log\max A_i)$.
## Решење када је $N\leq 100$
Овде за сваки бит можемо да идемо редом кроз и видимо да ли је на јединственој позицији сетован на један, и тиме сваки упит решимо у $O(N\log\max A_i)$.

## Решење када нема упита првог типа
Уколико нема промена низа, можемо за сваки бит да запамтимо прво следеће и прво претходно појављивање на свакој позицији. Онда можемо преко тих низова лако у $O(\log\max A_i)$ по упиту да нађемо одговор.

## Главно решење
Слично као у трећем задатку видимо да   ако је интервал дужине $>60$ онда је одговор $0$. Заиста, јер је сваки број позитиван, сваки има барем по један бит сетован на $1$, али онда по Дирихлеовом принципу мора да постоје два броја са заједничким битом, па Ања не може да победи. Ако је интервал дужине до $60$ можемо да извршимо проверу у линеарном времену као у $4$ подзадатку, па нам треба $O(\log^2\max A_i)$ по упиту.
