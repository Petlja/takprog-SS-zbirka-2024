---
title: Домски слетач - опис решења
---

## Домски слетач

Аутор: Марко Миленковић 

Текст: и тест примери: Марко Миленковић

Анализа решења: Марко Миленковић

Тестирање: Драган Урошевић

###  $NM \leq 20$
У овом подзадатку је довољно изгенерисати све могуће путеве (нпр. бектрекинг алгоритмом) и проверити за свако поље колико су неистомишљеници удаљени од тог пута. На крају само исписујемо минимум свих збирних удаљености.

### $N=2$
У овом подзадатку је кључно приметити да тиме што посматрана матрица има два реда, Домски Слетач ће се само једном спустити у други (нижи) ред. Нека то буде из поља $(1, X)$ у поље $(2, X)$. Како неистомишљеници могу такође да се крећу само доле и десно, сви неистомишљеници из првог реда десно од поља $(1,X)$, ће морати да се спусте једно поље наниже. Са друге стране, неистомишљеници из другог реда лево од поља $(2,X)$, ће морати да иду на десну страну до поља $(2, X)$. Коначна сума за фиксирано $X$ биће $\sum_{j=X+1}^M a_{1j} + \sum_{j=1}^{X-1} \left( a_{2j}\cdot (X-j) \right)$. Множење са $(X-j)$ заправо одређује колико путању ће прећи неистомишљеници из другог реда. Итерираћемо по $X$, а тражене суме можемо да израчунамо пре тога како не бисмо добили квадратну сложеност. Коначно, временска сложеност овог приступа је $\mathcal{O}(M)$.
###  $NM \leq 10^4$

Приметимо да се у прошлом подзадатку сваки неистомишљеник кретао само доле или само десно. Ако уопштимо закључак добијамо да ако фиксирамо путању Домског Слетача и уколико се неистомишљеник налази испод ње, најближе поље путање ће управо бити оно које је прво гледајући само надесно. Слично, неистомишљеницима који су изнад путање је оптимално да се спусте само доле до првог поља путање. Имајући у обзир да и Домски Слетач и неистомишљеници крећу само доле и десно, може се лако показати да су им то најближа поља.

Уз овај закључак можемо да формирамо стање динамичког програмирања: $dp[i][j]$ нам представља одговор на поставку задатка али за подматрицу до $i$-тог реда и $j$-те колоне (колика је минимална дистанца коју сви неистомишљеници из ове подматрице морају да пређу да би стигли до путање Домског Слетача који се креће од поља $(1,1)$ до поља $(i,j)$). Јасно, у почетку је $dp[1][x] = dp[y][1] = 0$ за свако $x=1,2,\ldots,M$ и $y=1,2,\ldots,N$. У поље $(i,j)$ можемо доћи с горње стране, односно из поља $(i-1,j)$, или с леве стране односно из поља $(i,j-1)$. У првом случају минимална дистанца биће $dp[i-1][j] + \sum_{k=1}^{j-1} \left( a_{ik}\cdot (j-k) \right)$, јер неистомишљеници из $i$-тог реда с леве стране од тренутног поља баш долазе у поље $(i,j)$. Сличним резоновањем, у другом случају минимална дистанце биће. На крају, прелаз динамичког програмирања биће $dp[i][j-1]+\sum_{k=1}^{i-1}\left( a_{kj}\cdot (i-k)\right)$. За $dp[i][j]$ узимамо мању од ове две вредности. Коначно решење је $dp[N][M]$. Укупна временска сложеност овог алгоритма је $\mathcal{O}(NM(N+M))$.  

### Решење без додатних ограничења

Једино што нас спречава да достигнемо жељену сложеност $\mathcal{O}(NM)$ у претходном решењу јесте споро рачунање прелаза за $dp[i][j]$. Приметимо да исто као и у другом подзадатку можемо да пре рачунања прелаза и стања додатне суме. Односно, израчунаћемо $r[i][j]$ најмања дистанца да сви неистомишљеници из реда $i$ а у колонама $1,2,\ldots,j-1$ дођу до поља $(i,j)$. Слично, $c[i][j]$ најмања дистанца да сви неистомишљеници из колоне $ј$ а у редовима $1,2,\ldots,i-1$ дођу до поља $(i,j)$. Прелазе рачунамо по формули $r[i][j] = r[i][j-1] + \sum_{k=1}^{j-1}a_{ij}$ (посматрамо ово на следећи начин: као да су до суседног поља лево сви неистомишљеници дошли и онда сви заједно прешли за једно поље удесно се померили) и $c[i][j] = c[i-1][j]  + \sum_{k=1}^{i-1}a_{ij}$. Приметимо да ове додатне суме нису ништа него префиксне суме по редовима и колонама, које можемо такође унапред да израчунамо и обележимо са $pref\_r[i][j]$ и $pref\_c[i][j]$. Сада нам прелази изледају овако: $r[i][j] = r[i][j-1] + pref\_r[i][j-1]$ и $c[i][j] = c[i-1][j]  + pref\_c[i-1][j]$. Коначно, почетни прелаз из претходног подзадатка добија следећу форму $dp[i][j] = \min(dp[i-1][j] + r[i][j], dp[i][j-1] + c[i][j])$. Временска сложеност овог решења је $\mathcal{O}(NM)$.

### Напомена

У скоро свим подзадацима је потребно да се користи $64$-битни тип података за рачунање, јер крајњи одговор може да буде знатно већи од $2\cdot 10^9$.
