---
title: И/или - опис решења
---

# И/или
 
Аутор: Александар Вишњић
Текст и тест примери: Момчило Тошић
Анализа решења: Александар Вишњић
Тестирање: Александар Вишњић

  

### Први подзадатак
Рекурзивно испробавање свих могућих примена операција осваја поене у овом подзадатку. Битно је оптимизовати ту рекурзију и не посетити ниједан низ више од двапут у истој команди. То се може остварити употребом скупа у коме чувамо све посећене низове.
  

### Други подзадатак
Приметимо да примена операције $A_i = A_i or A_{i+1}, \ A_{i+1} = A_i and A_{i+1}$ има тенденцију да "битове помера улево". Поновљеном применом овог поступка, слично као у алгоритму "bubble sort", можемо ефективно сортирати тренутни низ и наћи $K$-ти по реду елемент. Дословна груба имплементација доводи до решења другог подзадатка. Временска ложеност је $O(QN^2)$.

### Трећи подзадатак
Фиксирајмо неко $0 \leq i < 30$. Приметимо да се након примене операције укупан број елемената низа који садрже "бит" $2^i$ не мења. Уочимо поступак из претходног подзадатка. Резултат је тај да се сви "битови" налазе "збијено лево". Тачније, између сваке две јединице се такође налазе све јединице на одређеној месној вредности у бинарном запису.

Сада је довољно избројати сваки "бит", и у зависности од $K$ одредити да ли се он налази у $K$-том елементу крајњег низа $A$ или не. Директна симулација команди доводи до временске сложености $O(NQ\log M)$, где је $M$ највећа вредност низа $A$ .

  

### Четврти подзадатак
Слично као у претходним подзадацима, бројимо колико се пута "бит" појављује у низу. У овом случају је то једноставније јер су елементи низа $0$ и $1$. Дакле, бројимо само број јединица. За команду типа $1$, подешавамо бројач на нову одговарајућу вредност на основу промењеног елемента низа. За команду типа $0$, дајемо одговор у зависности од ажурираног броја јединица. Временска сложеност је $O(N)$. 

  

### Главно решење
Спајамо идеје из трећег и четвртог подзадатка. За сваки "бит" (од $0$ до $29$), бројимо колико се пута појављује у низу. За команду типа $1$, подешавамо бројаче на одговарајуће нове вредности. За команду типа $0$, дајемо одговор слично као у трећем подзадатку. Код сваке команде пролазимо по највише $30$ битова. Ово даје решење временске сложености $O((N+Q)\log M)$, где је $M$ највећа вредност низа $A$.
